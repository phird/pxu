{"version":3,"sources":["webpack:///./src/views/Setreceipt.vue?7a9e","webpack:///src/views/Setreceipt.vue","webpack:///./src/views/Setreceipt.vue?2eed","webpack:///./src/views/Setreceipt.vue","webpack:///./src/views/Setreceipt.vue?95e1"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_e","on","backward","tempimgslip","imgslip","style","previewImage","selectImage","staticStyle","_v","thFormat","model","value","callback","$$v","daterec","expression","ref","pickFile","submit","staticRenderFns","data","stringify","date","moment","parse","fileimg","inID","success","nerror","created","$route","params","id","getimg","methods","history","formData","axios","post","then","setTimeout","$refs","fileInput","click","file","reader","console","name","$emit","response","today","component"],"mappings":"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","file":"js/chunk-0de756c9.47a877e1.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"whole-site\"},[(_vm.nerror)?_c('a-alert',{attrs:{\"message\":\"โปรดใส่ข้อมูลให้ครบถ้วน\",\"type\":\"error\",\"show-icon\":\"\"}}):_vm._e(),(_vm.success)?_c('a-alert',{attrs:{\"message\":\"บันทึกข้อมูลสำเร็จ\",\"type\":\"success\",\"show-icon\":\"\"}}):_vm._e(),_c('div',{staticClass:\"header-site\"},[_c('b-icon',{attrs:{\"icon\":\"chevron-left\"},on:{\"click\":_vm.backward}})],1),_c('div',{staticClass:\"body-section\"},[_c('div',{staticClass:\"previewimg-section\"},[(_vm.tempimgslip != _vm.imgslip)?_c('div',{staticClass:\"imagePreviewWrapper\",style:({ 'background-image': (\"url(\" + _vm.previewImage + \")\") }),on:{\"click\":_vm.selectImage}},[_c('b-icon',{staticStyle:{\"color\":\"black\"},attrs:{\"icon\":\"card-image\"}})],1):_c('div',[_c('img',{staticClass:\"imagePreviewWrapper\",attrs:{\"src\":(\"https://pxu-server.herokuapp.com/slip/\" + _vm.imgslip),\"alt\":\"\"}})])]),_c('div',{staticClass:\"date-section\"},[_c('span',[_vm._v(\"วันที่ \")]),_c('span',[_c('date-picker',{attrs:{\"valueType\":\"format\",\"format\":_vm.thFormat},model:{value:(_vm.daterec),callback:function ($$v) {_vm.daterec=$$v},expression:\"daterec\"}})],1)]),_c('div',{staticClass:\"uploadFile-section\"},[_c('div',{staticClass:\"upload-slip\"},[_c('input',{ref:\"fileInput\",attrs:{\"type\":\"file\"},on:{\"input\":_vm.pickFile}})]),_c('button',{staticClass:\"btn btn-outline-success confirm-slip\",on:{\"click\":_vm.submit}},[_vm._v(\" แนบสลิป \")])])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"whole-site\">\r\n    <a-alert v-if=\"nerror\" message=\"โปรดใส่ข้อมูลให้ครบถ้วน\" type=\"error\" show-icon />\r\n     <a-alert v-if=\"success\" message=\"บันทึกข้อมูลสำเร็จ\" type=\"success\" show-icon />\r\n    <div class=\"header-site\">\r\n      <b-icon icon=\"chevron-left\" @click=\"backward\"> </b-icon>\r\n    </div>\r\n    <div class=\"body-section\">\r\n      <div class=\"previewimg-section\">\r\n        <div\r\n          v-if=\"tempimgslip != imgslip\"\r\n          class=\"imagePreviewWrapper\"\r\n          :style=\"{ 'background-image': `url(${previewImage})` }\"\r\n          @click=\"selectImage\"\r\n        >\r\n          <b-icon icon=\"card-image\" style=\"color: black\"> </b-icon>\r\n        </div>\r\n        <div v-else>\r\n          <img\r\n            :src=\"`https://pxu-server.herokuapp.com/slip/${imgslip}`\"\r\n            alt=\"\"\r\n            class=\"imagePreviewWrapper\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"date-section\">\r\n        <span>วันที่ </span>\r\n        <span\r\n          ><date-picker\r\n            v-model=\"daterec\"\r\n            valueType=\"format\"\r\n            :format=\"thFormat\"\r\n          ></date-picker>\r\n        </span>\r\n      </div>\r\n\r\n      <div class=\"uploadFile-section\">\r\n        <div class=\"upload-slip\">\r\n          <input ref=\"fileInput\" type=\"file\" @input=\"pickFile\" />\r\n        </div>\r\n        <button @click=\"submit\" class=\"btn btn-outline-success confirm-slip\">\r\n          แนบสลิป\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport moment from \"moment\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      thFormat: {\r\n        stringify: (date) => {\r\n          return date\r\n            ? moment(date).add(543, \"year\").format('DD/MM/YYYY')\r\n            : null;\r\n        },\r\n        parse: (daterec) => {\r\n          return daterec\r\n            ? moment(daterec, 'DD/MM/YYYY').subtract(543, \"year\").toDate()\r\n            : null;\r\n        },\r\n      },\r\n      previewImage: \"../../public/images/istockphoto-1147544806-170667a.jpg\",\r\n      daterec: \"\",\r\n      fileimg: [],\r\n      imgslip: \"\",\r\n      tempimgslip: \"\",\r\n      inID: \"\",\r\n      success:false,\r\n      nerror:false,\r\n    };\r\n  },\r\n  created() {\r\n    this.inID = this.$route.params.id;\r\n    this.getimg(this.inID);\r\n  },\r\n  methods: {\r\n    backward() {\r\n      history.back();\r\n    },\r\n    submit() {\r\n      if(this.imgslip=='' || this.daterec==''){\r\n        this.nerror=true;\r\n      }else{\r\n        let formData = new FormData();\r\n      formData.append(\"files\", this.fileimg);\r\n      axios.post(\"https://pxu-server.herokuapp.com/uploadslip\", formData, {});\r\n      axios.post(`https://pxu-server.herokuapp.com/invoice/re/changestatus/${this.inID}`);\r\n      axios\r\n        .post(`https://pxu-server.herokuapp.com/invoice/re/${this.inID}`, {\r\n          imgslip: this.imgslip,\r\n          daterec: this.daterec,\r\n        })\r\n        .then(() => {\r\n          this.success = true;\r\n            setTimeout(() => {\r\n              this.$router.back();\r\n            }, 500);\r\n        });\r\n        }\r\n      \r\n    },\r\n    selectImage() {\r\n      this.$refs.fileInput.click();\r\n    },\r\n    pickFile() {\r\n      let input = this.$refs.fileInput;\r\n      let file = input.files;\r\n      if (file && file[0]) {\r\n        let reader = new FileReader();\r\n        reader.onload = (e) => {\r\n          this.previewImage = e.target.result;\r\n        };\r\n        reader.readAsDataURL(file[0]);\r\n        console.log(file[0]);\r\n        this.fileimg = file[0];\r\n        this.imgslip = this.fileimg.name;\r\n        this.$emit(\"input\", file[0]);\r\n      }\r\n    },\r\n    async getimg(id) {\r\n      try {\r\n        const response = await axios.get(\r\n          `https://pxu-server.herokuapp.com/invoice/re/${id}`\r\n        );\r\n        if (response.data[0].datereceipt == '') {\r\n          var today = new Date();\r\n          this.daterec = moment(today).add(543, 'year').format('DD/MM/YYYY');\r\n        }else{\r\n          this.daterec = response.data[0].datereceipt;\r\n        }\r\n        this.imgslip = response.data[0].imgslip;\r\n        this.tempimgslip = response.data[0].imgslip;\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.whole-site {\r\n  display: flex;\r\n  flex-direction: column;\r\n  font-family: \"Mitr\", sans-serif;\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 14px;\r\n  background-color: white;\r\n  padding: 4em;\r\n  margin-bottom: 2em;\r\n  -webkit-box-shadow: 0 4px 24px 0 rgb(34 41 47 / 10%);\r\n  box-shadow: 0 4px 24px 0 rgb(34 41 47 / 10%);\r\n}\r\n.header-site {\r\n  display: flex;\r\n}\r\n.body-section {\r\n  display: flex;\r\n  width: 80%;\r\n  flex-direction: column;\r\n}\r\n\r\n.imagePreviewWrapper {\r\n  width: 250px;\r\n  height: 250px;\r\n  display: block;\r\n  cursor: pointer;\r\n  margin: 0 auto 30px;\r\n  background-size: cover;\r\n  background-color: rgb(211, 208, 208);\r\n  background-position: center center;\r\n}\r\n\r\n.date-section {\r\n  width: 50%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  text-align: center;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n}\r\n\r\n.uploadFile-section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-content: center;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n}\r\n\r\n.upload-slip {\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  padding: 2em;\r\n}\r\n\r\n.upload-slip input {\r\n  max-width: 220px;\r\n}\r\n\r\n.confirm-slip {\r\n  display: flex;\r\n  max-width: 220px;\r\n  text-align: center;\r\n  justify-content: center;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n}\r\n</style>","import mod from \"-!../../node_modules/@vue/cli-plugin-babel/node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./Setreceipt.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/@vue/cli-plugin-babel/node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./Setreceipt.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Setreceipt.vue?vue&type=template&id=ab4d6844&scoped=true&\"\nimport script from \"./Setreceipt.vue?vue&type=script&lang=js&\"\nexport * from \"./Setreceipt.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Setreceipt.vue?vue&type=style&index=0&id=ab4d6844&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ab4d6844\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./Setreceipt.vue?vue&type=style&index=0&id=ab4d6844&scoped=true&lang=scss&\""],"sourceRoot":""}
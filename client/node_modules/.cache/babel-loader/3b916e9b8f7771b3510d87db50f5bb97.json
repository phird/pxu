{"remainingRequest":"D:\\GitHub\\pxu-web\\client\\node_modules\\babel-loader\\lib\\index.js!D:\\GitHub\\pxu-web\\client\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\GitHub\\pxu-web\\client\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\GitHub\\pxu-web\\client\\src\\views\\Setreceipt.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\GitHub\\pxu-web\\client\\src\\views\\Setreceipt.vue","mtime":1653541092542},{"path":"D:\\GitHub\\pxu-web\\client\\babel.config.js","mtime":1651452852000},{"path":"D:\\GitHub\\pxu-web\\client\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651634972765},{"path":"D:\\GitHub\\pxu-web\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":1651453997873},{"path":"D:\\GitHub\\pxu-web\\client\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651634972757},{"path":"D:\\GitHub\\pxu-web\\client\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1651635696127}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkQ6L0dpdEh1Yi9weHUtd2ViL2NsaWVudC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvci5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBtb21lbnQgZnJvbSAibW9tZW50IjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB0aEZvcm1hdDogewogICAgICAgIHN0cmluZ2lmeTogZnVuY3Rpb24gc3RyaW5naWZ5KGRhdGUpIHsKICAgICAgICAgIHJldHVybiBkYXRlID8gbW9tZW50KGRhdGUpLmFkZCg1NDMsICJ5ZWFyIikuZm9ybWF0KCdERC9NTS9ZWVlZJykgOiBudWxsOwogICAgICAgIH0sCiAgICAgICAgcGFyc2U6IGZ1bmN0aW9uIHBhcnNlKGRhdGVyZWMpIHsKICAgICAgICAgIHJldHVybiBkYXRlcmVjID8gbW9tZW50KGRhdGVyZWMsICdERC9NTS9ZWVlZJykuc3VidHJhY3QoNTQzLCAieWVhciIpLnRvRGF0ZSgpIDogbnVsbDsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHByZXZpZXdJbWFnZTogIi4uLy4uL3B1YmxpYy9pbWFnZXMvaXN0b2NrcGhvdG8tMTE0NzU0NDgwNi0xNzA2NjdhLmpwZyIsCiAgICAgIGRhdGVyZWM6ICIiLAogICAgICBmaWxlaW1nOiBbXSwKICAgICAgaW1nc2xpcDogIiIsCiAgICAgIHRlbXBpbWdzbGlwOiAiIiwKICAgICAgaW5JRDogIiIsCiAgICAgIHN1Y2Nlc3M6IGZhbHNlLAogICAgICBuZXJyb3I6IGZhbHNlCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuaW5JRCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5pZDsKICAgIHRoaXMuZ2V0aW1nKHRoaXMuaW5JRCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBiYWNrd2FyZDogZnVuY3Rpb24gYmFja3dhcmQoKSB7CiAgICAgIGhpc3RvcnkuYmFjaygpOwogICAgfSwKICAgIHN1Ym1pdDogZnVuY3Rpb24gc3VibWl0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMuaW1nc2xpcCA9PSAnJyB8fCB0aGlzLmRhdGVyZWMgPT0gJycpIHsKICAgICAgICB0aGlzLm5lcnJvciA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJmaWxlcyIsIHRoaXMuZmlsZWltZyk7CiAgICAgICAgYXhpb3MucG9zdCgiaHR0cHM6Ly9weHUtc2VydmVyLmhlcm9rdWFwcC5jb20vdXBsb2Fkc2xpcCIsIGZvcm1EYXRhLCB7fSk7CiAgICAgICAgYXhpb3MucG9zdCgiaHR0cHM6Ly9weHUtc2VydmVyLmhlcm9rdWFwcC5jb20vaW52b2ljZS9yZS9jaGFuZ2VzdGF0dXMvIi5jb25jYXQodGhpcy5pbklEKSk7CiAgICAgICAgYXhpb3MucG9zdCgiaHR0cHM6Ly9weHUtc2VydmVyLmhlcm9rdWFwcC5jb20vaW52b2ljZS9yZS8iLmNvbmNhdCh0aGlzLmluSUQpLCB7CiAgICAgICAgICBpbWdzbGlwOiB0aGlzLmltZ3NsaXAsCiAgICAgICAgICBkYXRlcmVjOiB0aGlzLmRhdGVyZWMKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzLnN1Y2Nlc3MgPSB0cnVlOwogICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIF90aGlzLiRyb3V0ZXIuYmFjaygpOwogICAgICAgICAgfSwgNTAwKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIHNlbGVjdEltYWdlOiBmdW5jdGlvbiBzZWxlY3RJbWFnZSgpIHsKICAgICAgdGhpcy4kcmVmcy5maWxlSW5wdXQuY2xpY2soKTsKICAgIH0sCiAgICBwaWNrRmlsZTogZnVuY3Rpb24gcGlja0ZpbGUoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIGlucHV0ID0gdGhpcy4kcmVmcy5maWxlSW5wdXQ7CiAgICAgIHZhciBmaWxlID0gaW5wdXQuZmlsZXM7CgogICAgICBpZiAoZmlsZSAmJiBmaWxlWzBdKSB7CiAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CgogICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgX3RoaXMyLnByZXZpZXdJbWFnZSA9IGUudGFyZ2V0LnJlc3VsdDsKICAgICAgICB9OwoKICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlWzBdKTsKICAgICAgICBjb25zb2xlLmxvZyhmaWxlWzBdKTsKICAgICAgICB0aGlzLmZpbGVpbWcgPSBmaWxlWzBdOwogICAgICAgIHRoaXMuaW1nc2xpcCA9IHRoaXMuZmlsZWltZy5uYW1lOwogICAgICAgIHRoaXMuJGVtaXQoImlucHV0IiwgZmlsZVswXSk7CiAgICAgIH0KICAgIH0sCiAgICBnZXRpbWc6IGZ1bmN0aW9uIGdldGltZyhpZCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIHJlc3BvbnNlLCB0b2RheTsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIGF4aW9zLmdldCgiaHR0cHM6Ly9weHUtc2VydmVyLmhlcm9rdWFwcC5jb20vaW52b2ljZS9yZS8iLmNvbmNhdChpZCkpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGFbMF0uZGF0ZXJlY2VpcHQgPT0gJycpIHsKICAgICAgICAgICAgICAgICAgdG9kYXkgPSBuZXcgRGF0ZSgpOwogICAgICAgICAgICAgICAgICBfdGhpczMuZGF0ZXJlYyA9IG1vbWVudCh0b2RheSkuYWRkKDU0MywgJ3llYXInKS5mb3JtYXQoJ0REL01NL1lZWVknKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMy5kYXRlcmVjID0gcmVzcG9uc2UuZGF0YVswXS5kYXRlcmVjZWlwdDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczMuaW1nc2xpcCA9IHJlc3BvbnNlLmRhdGFbMF0uaW1nc2xpcDsKICAgICAgICAgICAgICAgIF90aGlzMy50ZW1waW1nc2xpcCA9IHJlc3BvbnNlLmRhdGFbMF0uaW1nc2xpcDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gOTsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMCk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhfY29udGV4dC50MCk7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzAsIDldXSk7CiAgICAgIH0pKSgpOwogICAgfQogIH0KfTs="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA;AACA;AACA;AACAA,MADA,kBACA;AACA;AACAC;AACAC;AACA,wBACAC,kDADA,GAEA,IAFA;AAGA,SALA;AAMAC;AACA,2BACAD,4DADA,GAEA,IAFA;AAGA;AAVA,OADA;AAaAE,4EAbA;AAcAC,iBAdA;AAeAC,iBAfA;AAgBAC,iBAhBA;AAiBAC,qBAjBA;AAkBAC,cAlBA;AAmBAC,oBAnBA;AAoBAC;AApBA;AAsBA,GAxBA;AAyBAC,SAzBA,qBAyBA;AACA;AACA;AACA,GA5BA;AA6BAC;AACAC,YADA,sBACA;AACAC;AACA,KAHA;AAIAC,UAJA,oBAIA;AAAA;;AACA;AACA;AACA,OAFA,MAEA;AACA;AACAC;AACAC;AACAA;AACAA,cACAC,IADA,uDACA,SADA,GACA;AACAZ,+BADA;AAEAF;AAFA,SADA,EAKAe,IALA,CAKA;AACA;AACAC;AACA;AACA,WAFA,EAEA,GAFA;AAGA,SAVA;AAWA;AAEA,KAzBA;AA0BAC,eA1BA,yBA0BA;AACA;AACA,KA5BA;AA6BAC,YA7BA,sBA6BA;AAAA;;AACA;AACA;;AACA;AACA;;AACAC;AACA;AACA,SAFA;;AAGAA;AACAC;AACA;AACA;AACA;AACA;AACA,KA3CA;AA4CAC,UA5CA,kBA4CAC,EA5CA,EA4CA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEAT,gEACAS,EADA,EAFA;;AAAA;AAEAC,wBAFA;;AAKA;AACAC,uBADA,GACA,UADA;AAEA;AACA,iBAHA,MAGA;AACA;AACA;;AACA;AACA;AAZA;AAAA;;AAAA;AAAA;AAAA;AAcAJ;;AAdA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgBA;AA5DA;AA7BA","names":["data","thFormat","stringify","moment","parse","previewImage","daterec","fileimg","imgslip","tempimgslip","inID","success","nerror","created","methods","backward","history","submit","formData","axios","post","then","setTimeout","selectImage","pickFile","reader","console","getimg","id","response","today"],"sourceRoot":"src/views","sources":["Setreceipt.vue"],"sourcesContent":["<template>\r\n  <div class=\"whole-site\">\r\n    <a-alert v-if=\"nerror\" message=\"โปรดใส่ข้อมูลให้ครบถ้วน\" type=\"error\" show-icon />\r\n     <a-alert v-if=\"success\" message=\"บันทึกข้อมูลสำเร็จ\" type=\"success\" show-icon />\r\n    <div class=\"header-site\">\r\n      <b-icon icon=\"chevron-left\" @click=\"backward\"> </b-icon>\r\n    </div>\r\n    <div class=\"body-section\">\r\n      <div class=\"previewimg-section\">\r\n        <div\r\n          v-if=\"tempimgslip != imgslip\"\r\n          class=\"imagePreviewWrapper\"\r\n          :style=\"{ 'background-image': `url(${previewImage})` }\"\r\n          @click=\"selectImage\"\r\n        >\r\n          <b-icon icon=\"card-image\" style=\"color: black\"> </b-icon>\r\n        </div>\r\n        <div v-else>\r\n          <img\r\n            :src=\"`https://pxu-server.herokuapp.com/slip/${imgslip}`\"\r\n            alt=\"\"\r\n            class=\"imagePreviewWrapper\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"date-section\">\r\n        <span>วันที่ </span>\r\n        <span\r\n          ><date-picker\r\n            v-model=\"daterec\"\r\n            valueType=\"format\"\r\n            :format=\"thFormat\"\r\n          ></date-picker>\r\n        </span>\r\n      </div>\r\n\r\n      <div class=\"uploadFile-section\">\r\n        <div class=\"upload-slip\">\r\n          <input ref=\"fileInput\" type=\"file\" @input=\"pickFile\" />\r\n        </div>\r\n        <button @click=\"submit\" class=\"btn btn-outline-success confirm-slip\">\r\n          แนบสลิป\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport moment from \"moment\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      thFormat: {\r\n        stringify: (date) => {\r\n          return date\r\n            ? moment(date).add(543, \"year\").format('DD/MM/YYYY')\r\n            : null;\r\n        },\r\n        parse: (daterec) => {\r\n          return daterec\r\n            ? moment(daterec, 'DD/MM/YYYY').subtract(543, \"year\").toDate()\r\n            : null;\r\n        },\r\n      },\r\n      previewImage: \"../../public/images/istockphoto-1147544806-170667a.jpg\",\r\n      daterec: \"\",\r\n      fileimg: [],\r\n      imgslip: \"\",\r\n      tempimgslip: \"\",\r\n      inID: \"\",\r\n      success:false,\r\n      nerror:false,\r\n    };\r\n  },\r\n  created() {\r\n    this.inID = this.$route.params.id;\r\n    this.getimg(this.inID);\r\n  },\r\n  methods: {\r\n    backward() {\r\n      history.back();\r\n    },\r\n    submit() {\r\n      if(this.imgslip=='' || this.daterec==''){\r\n        this.nerror=true;\r\n      }else{\r\n        let formData = new FormData();\r\n      formData.append(\"files\", this.fileimg);\r\n      axios.post(\"https://pxu-server.herokuapp.com/uploadslip\", formData, {});\r\n      axios.post(`https://pxu-server.herokuapp.com/invoice/re/changestatus/${this.inID}`);\r\n      axios\r\n        .post(`https://pxu-server.herokuapp.com/invoice/re/${this.inID}`, {\r\n          imgslip: this.imgslip,\r\n          daterec: this.daterec,\r\n        })\r\n        .then(() => {\r\n          this.success = true;\r\n            setTimeout(() => {\r\n              this.$router.back();\r\n            }, 500);\r\n        });\r\n        }\r\n      \r\n    },\r\n    selectImage() {\r\n      this.$refs.fileInput.click();\r\n    },\r\n    pickFile() {\r\n      let input = this.$refs.fileInput;\r\n      let file = input.files;\r\n      if (file && file[0]) {\r\n        let reader = new FileReader();\r\n        reader.onload = (e) => {\r\n          this.previewImage = e.target.result;\r\n        };\r\n        reader.readAsDataURL(file[0]);\r\n        console.log(file[0]);\r\n        this.fileimg = file[0];\r\n        this.imgslip = this.fileimg.name;\r\n        this.$emit(\"input\", file[0]);\r\n      }\r\n    },\r\n    async getimg(id) {\r\n      try {\r\n        const response = await axios.get(\r\n          `https://pxu-server.herokuapp.com/invoice/re/${id}`\r\n        );\r\n        if (response.data[0].datereceipt == '') {\r\n          var today = new Date();\r\n          this.daterec = moment(today).add(543, 'year').format('DD/MM/YYYY');\r\n        }else{\r\n          this.daterec = response.data[0].datereceipt;\r\n        }\r\n        this.imgslip = response.data[0].imgslip;\r\n        this.tempimgslip = response.data[0].imgslip;\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.whole-site {\r\n  display: flex;\r\n  flex-direction: column;\r\n  font-family: \"Mitr\", sans-serif;\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 14px;\r\n  background-color: white;\r\n  padding: 4em;\r\n  margin-bottom: 2em;\r\n  -webkit-box-shadow: 0 4px 24px 0 rgb(34 41 47 / 10%);\r\n  box-shadow: 0 4px 24px 0 rgb(34 41 47 / 10%);\r\n}\r\n.header-site {\r\n  display: flex;\r\n}\r\n.body-section {\r\n  display: flex;\r\n  width: 80%;\r\n  flex-direction: column;\r\n}\r\n\r\n.imagePreviewWrapper {\r\n  width: 250px;\r\n  height: 250px;\r\n  display: block;\r\n  cursor: pointer;\r\n  margin: 0 auto 30px;\r\n  background-size: cover;\r\n  background-color: rgb(211, 208, 208);\r\n  background-position: center center;\r\n}\r\n\r\n.date-section {\r\n  width: 50%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  text-align: center;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n}\r\n\r\n.uploadFile-section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-content: center;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n}\r\n\r\n.upload-slip {\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  padding: 2em;\r\n}\r\n\r\n.upload-slip input {\r\n  max-width: 220px;\r\n}\r\n\r\n.confirm-slip {\r\n  display: flex;\r\n  max-width: 220px;\r\n  text-align: center;\r\n  justify-content: center;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n}\r\n</style>"]}]}
{"remainingRequest":"D:\\GitHub\\pxu-web\\client\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\GitHub\\pxu-web\\client\\src\\views\\Setreceipt.vue?vue&type=style&index=0&id=6efc4b60&scoped=true&lang=scss&","dependencies":[{"path":"D:\\GitHub\\pxu-web\\client\\src\\views\\Setreceipt.vue","mtime":1653541092542},{"path":"D:\\GitHub\\pxu-web\\client\\node_modules\\css-loader\\dist\\cjs.js","mtime":1651454024138},{"path":"D:\\GitHub\\pxu-web\\client\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1651635696316},{"path":"D:\\GitHub\\pxu-web\\client\\node_modules\\postcss-loader\\src\\index.js","mtime":1651454063870},{"path":"D:\\GitHub\\pxu-web\\client\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1651454066580},{"path":"D:\\GitHub\\pxu-web\\client\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651634972757},{"path":"D:\\GitHub\\pxu-web\\client\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1651635696127}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi53aG9sZS1zaXRlIHsNCiAgZGlzcGxheTogZmxleDsNCiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgZm9udC1mYW1pbHk6ICJNaXRyIiwgc2Fucy1zZXJpZjsNCiAgd2lkdGg6IDEwMCU7DQogIGhlaWdodDogMTAwJTsNCiAgYm9yZGVyLXJhZGl1czogMTRweDsNCiAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7DQogIHBhZGRpbmc6IDRlbTsNCiAgbWFyZ2luLWJvdHRvbTogMmVtOw0KICAtd2Via2l0LWJveC1zaGFkb3c6IDAgNHB4IDI0cHggMCByZ2IoMzQgNDEgNDcgLyAxMCUpOw0KICBib3gtc2hhZG93OiAwIDRweCAyNHB4IDAgcmdiKDM0IDQxIDQ3IC8gMTAlKTsNCn0NCi5oZWFkZXItc2l0ZSB7DQogIGRpc3BsYXk6IGZsZXg7DQp9DQouYm9keS1zZWN0aW9uIHsNCiAgZGlzcGxheTogZmxleDsNCiAgd2lkdGg6IDgwJTsNCiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCn0NCg0KLmltYWdlUHJldmlld1dyYXBwZXIgew0KICB3aWR0aDogMjUwcHg7DQogIGhlaWdodDogMjUwcHg7DQogIGRpc3BsYXk6IGJsb2NrOw0KICBjdXJzb3I6IHBvaW50ZXI7DQogIG1hcmdpbjogMCBhdXRvIDMwcHg7DQogIGJhY2tncm91bmQtc2l6ZTogY292ZXI7DQogIGJhY2tncm91bmQtY29sb3I6IHJnYigyMTEsIDIwOCwgMjA4KTsNCiAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyIGNlbnRlcjsNCn0NCg0KLmRhdGUtc2VjdGlvbiB7DQogIHdpZHRoOiA1MCU7DQogIGRpc3BsYXk6IGZsZXg7DQogIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgbWFyZ2luLWxlZnQ6IGF1dG87DQogIG1hcmdpbi1yaWdodDogYXV0bzsNCn0NCg0KLnVwbG9hZEZpbGUtc2VjdGlvbiB7DQogIGRpc3BsYXk6IGZsZXg7DQogIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogIGFsaWduLWNvbnRlbnQ6IGNlbnRlcjsNCiAgbWFyZ2luLWxlZnQ6IGF1dG87DQogIG1hcmdpbi1yaWdodDogYXV0bzsNCn0NCg0KLnVwbG9hZC1zbGlwIHsNCiAgZGlzcGxheTogZmxleDsNCiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgbWFyZ2luLWxlZnQ6IGF1dG87DQogIG1hcmdpbi1yaWdodDogYXV0bzsNCiAgcGFkZGluZzogMmVtOw0KfQ0KDQoudXBsb2FkLXNsaXAgaW5wdXQgew0KICBtYXgtd2lkdGg6IDIyMHB4Ow0KfQ0KDQouY29uZmlybS1zbGlwIHsNCiAgZGlzcGxheTogZmxleDsNCiAgbWF4LXdpZHRoOiAyMjBweDsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgbWFyZ2luLWxlZnQ6IGF1dG87DQogIG1hcmdpbi1yaWdodDogYXV0bzsNCn0NCg=="},{"version":3,"sources":["Setreceipt.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Setreceipt.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"whole-site\">\r\n    <a-alert v-if=\"nerror\" message=\"โปรดใส่ข้อมูลให้ครบถ้วน\" type=\"error\" show-icon />\r\n     <a-alert v-if=\"success\" message=\"บันทึกข้อมูลสำเร็จ\" type=\"success\" show-icon />\r\n    <div class=\"header-site\">\r\n      <b-icon icon=\"chevron-left\" @click=\"backward\"> </b-icon>\r\n    </div>\r\n    <div class=\"body-section\">\r\n      <div class=\"previewimg-section\">\r\n        <div\r\n          v-if=\"tempimgslip != imgslip\"\r\n          class=\"imagePreviewWrapper\"\r\n          :style=\"{ 'background-image': `url(${previewImage})` }\"\r\n          @click=\"selectImage\"\r\n        >\r\n          <b-icon icon=\"card-image\" style=\"color: black\"> </b-icon>\r\n        </div>\r\n        <div v-else>\r\n          <img\r\n            :src=\"`https://pxu-server.herokuapp.com/slip/${imgslip}`\"\r\n            alt=\"\"\r\n            class=\"imagePreviewWrapper\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"date-section\">\r\n        <span>วันที่ </span>\r\n        <span\r\n          ><date-picker\r\n            v-model=\"daterec\"\r\n            valueType=\"format\"\r\n            :format=\"thFormat\"\r\n          ></date-picker>\r\n        </span>\r\n      </div>\r\n\r\n      <div class=\"uploadFile-section\">\r\n        <div class=\"upload-slip\">\r\n          <input ref=\"fileInput\" type=\"file\" @input=\"pickFile\" />\r\n        </div>\r\n        <button @click=\"submit\" class=\"btn btn-outline-success confirm-slip\">\r\n          แนบสลิป\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport moment from \"moment\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      thFormat: {\r\n        stringify: (date) => {\r\n          return date\r\n            ? moment(date).add(543, \"year\").format('DD/MM/YYYY')\r\n            : null;\r\n        },\r\n        parse: (daterec) => {\r\n          return daterec\r\n            ? moment(daterec, 'DD/MM/YYYY').subtract(543, \"year\").toDate()\r\n            : null;\r\n        },\r\n      },\r\n      previewImage: \"../../public/images/istockphoto-1147544806-170667a.jpg\",\r\n      daterec: \"\",\r\n      fileimg: [],\r\n      imgslip: \"\",\r\n      tempimgslip: \"\",\r\n      inID: \"\",\r\n      success:false,\r\n      nerror:false,\r\n    };\r\n  },\r\n  created() {\r\n    this.inID = this.$route.params.id;\r\n    this.getimg(this.inID);\r\n  },\r\n  methods: {\r\n    backward() {\r\n      history.back();\r\n    },\r\n    submit() {\r\n      if(this.imgslip=='' || this.daterec==''){\r\n        this.nerror=true;\r\n      }else{\r\n        let formData = new FormData();\r\n      formData.append(\"files\", this.fileimg);\r\n      axios.post(\"https://pxu-server.herokuapp.com/uploadslip\", formData, {});\r\n      axios.post(`https://pxu-server.herokuapp.com/invoice/re/changestatus/${this.inID}`);\r\n      axios\r\n        .post(`https://pxu-server.herokuapp.com/invoice/re/${this.inID}`, {\r\n          imgslip: this.imgslip,\r\n          daterec: this.daterec,\r\n        })\r\n        .then(() => {\r\n          this.success = true;\r\n            setTimeout(() => {\r\n              this.$router.back();\r\n            }, 500);\r\n        });\r\n        }\r\n      \r\n    },\r\n    selectImage() {\r\n      this.$refs.fileInput.click();\r\n    },\r\n    pickFile() {\r\n      let input = this.$refs.fileInput;\r\n      let file = input.files;\r\n      if (file && file[0]) {\r\n        let reader = new FileReader();\r\n        reader.onload = (e) => {\r\n          this.previewImage = e.target.result;\r\n        };\r\n        reader.readAsDataURL(file[0]);\r\n        console.log(file[0]);\r\n        this.fileimg = file[0];\r\n        this.imgslip = this.fileimg.name;\r\n        this.$emit(\"input\", file[0]);\r\n      }\r\n    },\r\n    async getimg(id) {\r\n      try {\r\n        const response = await axios.get(\r\n          `https://pxu-server.herokuapp.com/invoice/re/${id}`\r\n        );\r\n        if (response.data[0].datereceipt == '') {\r\n          var today = new Date();\r\n          this.daterec = moment(today).add(543, 'year').format('DD/MM/YYYY');\r\n        }else{\r\n          this.daterec = response.data[0].datereceipt;\r\n        }\r\n        this.imgslip = response.data[0].imgslip;\r\n        this.tempimgslip = response.data[0].imgslip;\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.whole-site {\r\n  display: flex;\r\n  flex-direction: column;\r\n  font-family: \"Mitr\", sans-serif;\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 14px;\r\n  background-color: white;\r\n  padding: 4em;\r\n  margin-bottom: 2em;\r\n  -webkit-box-shadow: 0 4px 24px 0 rgb(34 41 47 / 10%);\r\n  box-shadow: 0 4px 24px 0 rgb(34 41 47 / 10%);\r\n}\r\n.header-site {\r\n  display: flex;\r\n}\r\n.body-section {\r\n  display: flex;\r\n  width: 80%;\r\n  flex-direction: column;\r\n}\r\n\r\n.imagePreviewWrapper {\r\n  width: 250px;\r\n  height: 250px;\r\n  display: block;\r\n  cursor: pointer;\r\n  margin: 0 auto 30px;\r\n  background-size: cover;\r\n  background-color: rgb(211, 208, 208);\r\n  background-position: center center;\r\n}\r\n\r\n.date-section {\r\n  width: 50%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  text-align: center;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n}\r\n\r\n.uploadFile-section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-content: center;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n}\r\n\r\n.upload-slip {\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  padding: 2em;\r\n}\r\n\r\n.upload-slip input {\r\n  max-width: 220px;\r\n}\r\n\r\n.confirm-slip {\r\n  display: flex;\r\n  max-width: 220px;\r\n  text-align: center;\r\n  justify-content: center;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n}\r\n</style>"]}]}
{"remainingRequest":"D:\\GitHub\\pxu-web\\client\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\GitHub\\pxu-web\\client\\src\\views\\Setreceipt.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\GitHub\\pxu-web\\client\\src\\views\\Setreceipt.vue","mtime":1653541092542},{"path":"D:\\GitHub\\pxu-web\\client\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651634972765},{"path":"D:\\GitHub\\pxu-web\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":1651453997873},{"path":"D:\\GitHub\\pxu-web\\client\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651634972757},{"path":"D:\\GitHub\\pxu-web\\client\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1651635696127}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgYXhpb3MgZnJvbSAiYXhpb3MiOw0KaW1wb3J0IG1vbWVudCBmcm9tICJtb21lbnQiOw0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICB0aEZvcm1hdDogew0KICAgICAgICBzdHJpbmdpZnk6IChkYXRlKSA9PiB7DQogICAgICAgICAgcmV0dXJuIGRhdGUNCiAgICAgICAgICAgID8gbW9tZW50KGRhdGUpLmFkZCg1NDMsICJ5ZWFyIikuZm9ybWF0KCdERC9NTS9ZWVlZJykNCiAgICAgICAgICAgIDogbnVsbDsNCiAgICAgICAgfSwNCiAgICAgICAgcGFyc2U6IChkYXRlcmVjKSA9PiB7DQogICAgICAgICAgcmV0dXJuIGRhdGVyZWMNCiAgICAgICAgICAgID8gbW9tZW50KGRhdGVyZWMsICdERC9NTS9ZWVlZJykuc3VidHJhY3QoNTQzLCAieWVhciIpLnRvRGF0ZSgpDQogICAgICAgICAgICA6IG51bGw7DQogICAgICAgIH0sDQogICAgICB9LA0KICAgICAgcHJldmlld0ltYWdlOiAiLi4vLi4vcHVibGljL2ltYWdlcy9pc3RvY2twaG90by0xMTQ3NTQ0ODA2LTE3MDY2N2EuanBnIiwNCiAgICAgIGRhdGVyZWM6ICIiLA0KICAgICAgZmlsZWltZzogW10sDQogICAgICBpbWdzbGlwOiAiIiwNCiAgICAgIHRlbXBpbWdzbGlwOiAiIiwNCiAgICAgIGluSUQ6ICIiLA0KICAgICAgc3VjY2VzczpmYWxzZSwNCiAgICAgIG5lcnJvcjpmYWxzZSwNCiAgICB9Ow0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIHRoaXMuaW5JRCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5pZDsNCiAgICB0aGlzLmdldGltZyh0aGlzLmluSUQpOw0KICB9LA0KICBtZXRob2RzOiB7DQogICAgYmFja3dhcmQoKSB7DQogICAgICBoaXN0b3J5LmJhY2soKTsNCiAgICB9LA0KICAgIHN1Ym1pdCgpIHsNCiAgICAgIGlmKHRoaXMuaW1nc2xpcD09JycgfHwgdGhpcy5kYXRlcmVjPT0nJyl7DQogICAgICAgIHRoaXMubmVycm9yPXRydWU7DQogICAgICB9ZWxzZXsNCiAgICAgICAgbGV0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7DQogICAgICBmb3JtRGF0YS5hcHBlbmQoImZpbGVzIiwgdGhpcy5maWxlaW1nKTsNCiAgICAgIGF4aW9zLnBvc3QoImh0dHBzOi8vcHh1LXNlcnZlci5oZXJva3VhcHAuY29tL3VwbG9hZHNsaXAiLCBmb3JtRGF0YSwge30pOw0KICAgICAgYXhpb3MucG9zdChgaHR0cHM6Ly9weHUtc2VydmVyLmhlcm9rdWFwcC5jb20vaW52b2ljZS9yZS9jaGFuZ2VzdGF0dXMvJHt0aGlzLmluSUR9YCk7DQogICAgICBheGlvcw0KICAgICAgICAucG9zdChgaHR0cHM6Ly9weHUtc2VydmVyLmhlcm9rdWFwcC5jb20vaW52b2ljZS9yZS8ke3RoaXMuaW5JRH1gLCB7DQogICAgICAgICAgaW1nc2xpcDogdGhpcy5pbWdzbGlwLA0KICAgICAgICAgIGRhdGVyZWM6IHRoaXMuZGF0ZXJlYywNCiAgICAgICAgfSkNCiAgICAgICAgLnRoZW4oKCkgPT4gew0KICAgICAgICAgIHRoaXMuc3VjY2VzcyA9IHRydWU7DQogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLmJhY2soKTsNCiAgICAgICAgICAgIH0sIDUwMCk7DQogICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICANCiAgICB9LA0KICAgIHNlbGVjdEltYWdlKCkgew0KICAgICAgdGhpcy4kcmVmcy5maWxlSW5wdXQuY2xpY2soKTsNCiAgICB9LA0KICAgIHBpY2tGaWxlKCkgew0KICAgICAgbGV0IGlucHV0ID0gdGhpcy4kcmVmcy5maWxlSW5wdXQ7DQogICAgICBsZXQgZmlsZSA9IGlucHV0LmZpbGVzOw0KICAgICAgaWYgKGZpbGUgJiYgZmlsZVswXSkgew0KICAgICAgICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICAgICAgcmVhZGVyLm9ubG9hZCA9IChlKSA9PiB7DQogICAgICAgICAgdGhpcy5wcmV2aWV3SW1hZ2UgPSBlLnRhcmdldC5yZXN1bHQ7DQogICAgICAgIH07DQogICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGVbMF0pOw0KICAgICAgICBjb25zb2xlLmxvZyhmaWxlWzBdKTsNCiAgICAgICAgdGhpcy5maWxlaW1nID0gZmlsZVswXTsNCiAgICAgICAgdGhpcy5pbWdzbGlwID0gdGhpcy5maWxlaW1nLm5hbWU7DQogICAgICAgIHRoaXMuJGVtaXQoImlucHV0IiwgZmlsZVswXSk7DQogICAgICB9DQogICAgfSwNCiAgICBhc3luYyBnZXRpbWcoaWQpIHsNCiAgICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KA0KICAgICAgICAgIGBodHRwczovL3B4dS1zZXJ2ZXIuaGVyb2t1YXBwLmNvbS9pbnZvaWNlL3JlLyR7aWR9YA0KICAgICAgICApOw0KICAgICAgICBpZiAocmVzcG9uc2UuZGF0YVswXS5kYXRlcmVjZWlwdCA9PSAnJykgew0KICAgICAgICAgIHZhciB0b2RheSA9IG5ldyBEYXRlKCk7DQogICAgICAgICAgdGhpcy5kYXRlcmVjID0gbW9tZW50KHRvZGF5KS5hZGQoNTQzLCAneWVhcicpLmZvcm1hdCgnREQvTU0vWVlZWScpOw0KICAgICAgICB9ZWxzZXsNCiAgICAgICAgICB0aGlzLmRhdGVyZWMgPSByZXNwb25zZS5kYXRhWzBdLmRhdGVyZWNlaXB0Ow0KICAgICAgICB9DQogICAgICAgIHRoaXMuaW1nc2xpcCA9IHJlc3BvbnNlLmRhdGFbMF0uaW1nc2xpcDsNCiAgICAgICAgdGhpcy50ZW1waW1nc2xpcCA9IHJlc3BvbnNlLmRhdGFbMF0uaW1nc2xpcDsNCiAgICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICBjb25zb2xlLmxvZyhlcnIpOw0KICAgICAgfQ0KICAgIH0sDQogIH0sDQp9Ow0K"},{"version":3,"sources":["Setreceipt.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Setreceipt.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"whole-site\">\r\n    <a-alert v-if=\"nerror\" message=\"โปรดใส่ข้อมูลให้ครบถ้วน\" type=\"error\" show-icon />\r\n     <a-alert v-if=\"success\" message=\"บันทึกข้อมูลสำเร็จ\" type=\"success\" show-icon />\r\n    <div class=\"header-site\">\r\n      <b-icon icon=\"chevron-left\" @click=\"backward\"> </b-icon>\r\n    </div>\r\n    <div class=\"body-section\">\r\n      <div class=\"previewimg-section\">\r\n        <div\r\n          v-if=\"tempimgslip != imgslip\"\r\n          class=\"imagePreviewWrapper\"\r\n          :style=\"{ 'background-image': `url(${previewImage})` }\"\r\n          @click=\"selectImage\"\r\n        >\r\n          <b-icon icon=\"card-image\" style=\"color: black\"> </b-icon>\r\n        </div>\r\n        <div v-else>\r\n          <img\r\n            :src=\"`https://pxu-server.herokuapp.com/slip/${imgslip}`\"\r\n            alt=\"\"\r\n            class=\"imagePreviewWrapper\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"date-section\">\r\n        <span>วันที่ </span>\r\n        <span\r\n          ><date-picker\r\n            v-model=\"daterec\"\r\n            valueType=\"format\"\r\n            :format=\"thFormat\"\r\n          ></date-picker>\r\n        </span>\r\n      </div>\r\n\r\n      <div class=\"uploadFile-section\">\r\n        <div class=\"upload-slip\">\r\n          <input ref=\"fileInput\" type=\"file\" @input=\"pickFile\" />\r\n        </div>\r\n        <button @click=\"submit\" class=\"btn btn-outline-success confirm-slip\">\r\n          แนบสลิป\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport moment from \"moment\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      thFormat: {\r\n        stringify: (date) => {\r\n          return date\r\n            ? moment(date).add(543, \"year\").format('DD/MM/YYYY')\r\n            : null;\r\n        },\r\n        parse: (daterec) => {\r\n          return daterec\r\n            ? moment(daterec, 'DD/MM/YYYY').subtract(543, \"year\").toDate()\r\n            : null;\r\n        },\r\n      },\r\n      previewImage: \"../../public/images/istockphoto-1147544806-170667a.jpg\",\r\n      daterec: \"\",\r\n      fileimg: [],\r\n      imgslip: \"\",\r\n      tempimgslip: \"\",\r\n      inID: \"\",\r\n      success:false,\r\n      nerror:false,\r\n    };\r\n  },\r\n  created() {\r\n    this.inID = this.$route.params.id;\r\n    this.getimg(this.inID);\r\n  },\r\n  methods: {\r\n    backward() {\r\n      history.back();\r\n    },\r\n    submit() {\r\n      if(this.imgslip=='' || this.daterec==''){\r\n        this.nerror=true;\r\n      }else{\r\n        let formData = new FormData();\r\n      formData.append(\"files\", this.fileimg);\r\n      axios.post(\"https://pxu-server.herokuapp.com/uploadslip\", formData, {});\r\n      axios.post(`https://pxu-server.herokuapp.com/invoice/re/changestatus/${this.inID}`);\r\n      axios\r\n        .post(`https://pxu-server.herokuapp.com/invoice/re/${this.inID}`, {\r\n          imgslip: this.imgslip,\r\n          daterec: this.daterec,\r\n        })\r\n        .then(() => {\r\n          this.success = true;\r\n            setTimeout(() => {\r\n              this.$router.back();\r\n            }, 500);\r\n        });\r\n        }\r\n      \r\n    },\r\n    selectImage() {\r\n      this.$refs.fileInput.click();\r\n    },\r\n    pickFile() {\r\n      let input = this.$refs.fileInput;\r\n      let file = input.files;\r\n      if (file && file[0]) {\r\n        let reader = new FileReader();\r\n        reader.onload = (e) => {\r\n          this.previewImage = e.target.result;\r\n        };\r\n        reader.readAsDataURL(file[0]);\r\n        console.log(file[0]);\r\n        this.fileimg = file[0];\r\n        this.imgslip = this.fileimg.name;\r\n        this.$emit(\"input\", file[0]);\r\n      }\r\n    },\r\n    async getimg(id) {\r\n      try {\r\n        const response = await axios.get(\r\n          `https://pxu-server.herokuapp.com/invoice/re/${id}`\r\n        );\r\n        if (response.data[0].datereceipt == '') {\r\n          var today = new Date();\r\n          this.daterec = moment(today).add(543, 'year').format('DD/MM/YYYY');\r\n        }else{\r\n          this.daterec = response.data[0].datereceipt;\r\n        }\r\n        this.imgslip = response.data[0].imgslip;\r\n        this.tempimgslip = response.data[0].imgslip;\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.whole-site {\r\n  display: flex;\r\n  flex-direction: column;\r\n  font-family: \"Mitr\", sans-serif;\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 14px;\r\n  background-color: white;\r\n  padding: 4em;\r\n  margin-bottom: 2em;\r\n  -webkit-box-shadow: 0 4px 24px 0 rgb(34 41 47 / 10%);\r\n  box-shadow: 0 4px 24px 0 rgb(34 41 47 / 10%);\r\n}\r\n.header-site {\r\n  display: flex;\r\n}\r\n.body-section {\r\n  display: flex;\r\n  width: 80%;\r\n  flex-direction: column;\r\n}\r\n\r\n.imagePreviewWrapper {\r\n  width: 250px;\r\n  height: 250px;\r\n  display: block;\r\n  cursor: pointer;\r\n  margin: 0 auto 30px;\r\n  background-size: cover;\r\n  background-color: rgb(211, 208, 208);\r\n  background-position: center center;\r\n}\r\n\r\n.date-section {\r\n  width: 50%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  text-align: center;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n}\r\n\r\n.uploadFile-section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-content: center;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n}\r\n\r\n.upload-slip {\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  padding: 2em;\r\n}\r\n\r\n.upload-slip input {\r\n  max-width: 220px;\r\n}\r\n\r\n.confirm-slip {\r\n  display: flex;\r\n  max-width: 220px;\r\n  text-align: center;\r\n  justify-content: center;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n}\r\n</style>"]}]}